using CUDNN backend
Train:
X.shape: (3840, 3, 200, 200)
y.shape: (3840,)
y value counts:  [ 794 3046]
pictures size:  1.0
Labels ratio: 3.84
Input arguments: {'load': None, 'scale_delta': 0.1, 'test_file': 'test.npz', 'network': 'AlexNet', 'data_augmentation': 'resampling', 'final_ratio': 1.5, 'activation_function': <function rectify at 0x7f5ba4ab9b90>, 'train_file': 'train.npz', 'activation': 'rectify', 'max_trans': 5, 'batch_size': 256, 'dataset_ratio': 3.836272040302267, 'patience': 5, 'angle_factor': 1.0, 'learning_init': 0.005, 'learning_final': 0.0001, 'max_epochs': 200, 'nb_channels': 3, 'lambda2': 0.001, 'crop_size': 200}
Resampling batch iterator parameters: {'count': 0, 'final_ratio': 1.5, 'nb_channels': 3, 'pad_size': 100, 'scale_delta': 0.1, 'output': <open file '<stdout>', mode 'w' at 0x7f5bdae3b150>, 'dataset_ratio': 3.836272040302267, 'batch_size': 256, 'angle_factor': 1.0, 'max_epochs': 200, 'max_trans': 5, 'shear': None, 'crop_size': 200}
# Neural Network with 30846658 learnable parameters

## Layer information

name           size         total    cap.Y    cap.X    cov.Y    cov.X    filter Y    filter X    field Y    field X
-------------  ---------  -------  -------  -------  -------  -------  ----------  ----------  ---------  ---------
input0         3x200x200   120000   100.00   100.00   100.00   100.00         200         200        200        200
conv2ddnn1     48x48x48    110592   100.00   100.00     5.50     5.50          11          11         11         11
maxpool2ddnn2  48x23x23     25392   100.00   100.00     5.50     5.50          11          11         11         11
conv2ddnn3     128x23x23    67712    65.22    65.22    11.50    11.50          15          15         23         23
maxpool2ddnn4  128x11x11    15488    65.22    65.22    11.50    11.50          15          15         23         23
conv2ddnn5     192x11x11    23232    65.85    65.85    20.50    20.50          27          27         41         41
conv2ddnn6     192x11x11    23232    45.76    45.76    29.50    29.50          27          27         59         59
conv2ddnn7     128x11x11    15488    35.06    35.06    38.50    38.50          27          27         77         77
maxpool2ddnn8  128x5x5       3200    35.06    35.06    38.50    38.50          27          27         77         77
dense9         4096          4096   100.00   100.00   100.00   100.00         200         200        200        200
dropout10      4096          4096   100.00   100.00   100.00   100.00         200         200        200        200
dense11        4096          4096   100.00   100.00   100.00   100.00         200         200        200        200
dense12        2                2   100.00   100.00   100.00   100.00         200         200        200        200

Explanation
    X, Y:    image dimensions
    cap.:    learning capacity
    cov.:    coverage of image
    [35mmagenta[0m: capacity too low (<1/6)
    [36mcyan[0m:    image coverage too high (>100%)
    [31mred[0m:     capacity too low and coverage too high


  epoch    train loss    valid loss    train/val    valid acc    AUC-ROC  dur
-------  ------------  ------------  -----------  -----------  ---------  ------
      1       [36m8.95277[0m       [32m8.94192[0m      1.00121      0.54883    0.50701  82.92s
      2       [36m8.91264[0m       [32m8.87431[0m      1.00432      0.62891    0.53904  72.82s
      3       [36m8.83808[0m       8.89223      0.99391      0.61133    0.57046  73.12s
      4       [36m8.79491[0m       [32m8.71510[0m      1.00916      0.76367    0.58848  74.51s
      5       [36m8.73465[0m       8.88680      0.98288      0.61133    0.59364  72.95s
      6       [36m8.70326[0m       [32m8.64013[0m      1.00731      0.79297    0.60387  72.81s
      7       [36m8.65262[0m       [32m8.58104[0m      1.00834      0.83984    0.61125  73.11s
      8       8.65397       8.60707      1.00545      0.78906    0.61284  72.91s
      9       [36m8.60798[0m       [32m8.56752[0m      1.00472      0.80078    0.62941  72.92s
     10       [36m8.52988[0m       [32m8.55009[0m      0.99764      0.76562    0.64117  74.29s
     11       8.60756       8.55547      1.00609      0.78906    0.60455  73.18s
     12       8.53025       [32m8.49029[0m      1.00471      0.80469    0.62506  73.03s
     13       [36m8.45515[0m       8.52985      0.99124      0.76758    0.64203  74.48s
     14       8.46344       [32m8.43323[0m      1.00358      0.79688    0.64645  74.02s
     15       [36m8.38984[0m       [32m8.38079[0m      1.00108      0.83398    0.65330  72.82s
     16       8.40889       8.38965      1.00229      0.81055    0.65514  74.17s
     17       [36m8.33930[0m       8.39042      0.99391      0.78125    0.65548  74.48s
     18       [36m8.32890[0m       [32m8.35865[0m      0.99644      0.82812    0.65860  74.34s
     19       [36m8.29028[0m       [32m8.34130[0m      0.99388      0.63281    0.66694  73.19s
     20       8.29247       8.34226      0.99403      0.82422    0.65748  74.21s
     21       [36m8.23720[0m       8.48720      0.97054      0.68164    0.65989  74.55s
     22       8.23756       [32m8.21857[0m      1.00231      0.82227    0.67616  74.20s
     23       [36m8.17692[0m       8.25336      0.99074      0.77539    0.67201  73.17s
     24       [36m8.14212[0m       [32m8.18215[0m      0.99511      0.87305    0.67624  73.01s
     25       [36m8.12811[0m       [32m8.15065[0m      0.99724      0.82617    0.67969  74.63s
     26       [36m8.09006[0m       8.20510      0.98598      0.59766    0.68715  72.96s
     27       [36m8.05376[0m       8.22681      0.97896      0.63672    0.68725  73.12s
     28       8.12256       [32m8.14983[0m      0.99665      0.59961    0.67400  72.94s
     29       [36m8.04614[0m       [32m8.13070[0m      0.98960      0.83398    0.68509  74.43s
     30       [36m7.99941[0m       [32m8.01514[0m      0.99804      0.87305    0.68427  73.08s
     31       [36m7.96020[0m       8.07160      0.98620      0.61914    0.69461  74.42s
     32       [36m7.95858[0m       [32m7.95737[0m      1.00015      0.89062    0.69764  74.21s
     33       [36m7.91778[0m       7.99167      0.99075      0.81055    0.69400  72.97s
     34       [36m7.87624[0m       8.05067      0.97833      0.77930    0.69014  73.22s
     35       [36m7.87509[0m       8.02503      0.98132      0.60742    0.68999  73.15s
     36       [36m7.84232[0m       [32m7.93827[0m      0.98791      0.64453    0.69648  73.03s
     37       7.85701       [32m7.89279[0m      0.99547      0.63867    0.69651  74.15s
     38       [36m7.77054[0m       7.96324      0.97580      0.78906    0.69608  72.92s
     39       [36m7.75402[0m       7.95923      0.97422      0.80859    0.69711  72.84s
     40       7.76796       [32m7.88441[0m      0.98523      0.65820    0.69734  72.74s
     41       [36m7.71035[0m       [32m7.77497[0m      0.99169      0.90625    0.70507  74.11s
     42       [36m7.68194[0m       [32m7.77090[0m      0.98855      0.66016    0.70704  73.12s
     43       [36m7.65216[0m       7.77268      0.98450      0.81445    0.69823  74.05s
     44       [36m7.63231[0m       [32m7.64791[0m      0.99796      0.88281    0.70456  73.95s
     45       [36m7.62702[0m       7.67387      0.99390      0.84570    0.70443  72.81s
     46       [36m7.56595[0m       [32m7.62438[0m      0.99234      0.87109    0.70646  72.82s
     47       7.57959       [32m7.53652[0m      1.00572      0.91992    0.71043  74.17s
     48       7.57364       7.57572      0.99973      0.86523    0.70901  72.76s
     49       [36m7.50657[0m       7.63439      0.98326      0.67773    0.70423  72.90s
     50       [36m7.49849[0m       7.64813      0.98043      0.67383    0.70741  72.65s
     51       [36m7.46621[0m       7.64029      0.97722      0.66992    0.70618  73.10s
     52       [36m7.43763[0m       [32m7.51533[0m      0.98966      0.86914    0.71132  72.73s
     53       [36m7.42268[0m       [32m7.44172[0m      0.99744      0.90039    0.71069  74.02s
     54       [36m7.41216[0m       [32m7.43930[0m      0.99635      0.88086    0.71381  72.66s
     55       [36m7.37290[0m       [32m7.37637[0m      0.99953      0.91016    0.71504  74.35s
     56       [36m7.34077[0m       7.46077      0.98392      0.84570    0.71447  72.69s
     57       [36m7.33121[0m       7.53865      0.97248      0.68164    0.71036  72.83s
     58       [36m7.29838[0m       [32m7.36625[0m      0.99079      0.88086    0.70633  72.65s
     59       7.30148       7.37621      0.98987      0.89062    0.71524  74.18s
     60       [36m7.25203[0m       7.39425      0.98077      0.67383    0.71445  73.90s
     61       [36m7.22786[0m       [32m7.35976[0m      0.98208      0.87109    0.71325  73.98s
     62       7.22976       7.36556      0.98156      0.85938    0.71173  72.75s
     63       [36m7.18551[0m       [32m7.23906[0m      0.99260      0.87305    0.71229  72.88s
     64       [36m7.18172[0m       [32m7.22535[0m      0.99396      0.89453    0.71789  74.06s
     65       [36m7.16091[0m       [32m7.21231[0m      0.99287      0.91016    0.71697  72.86s
     66       [36m7.12097[0m       7.31607      0.97333      0.83203    0.71438  73.85s
     67       [36m7.10457[0m       7.22772      0.98296      0.85938    0.71365  74.13s
     68       [36m7.06423[0m       [32m7.18968[0m      0.98255      0.87695    0.71972  74.05s
     69       [36m7.05989[0m       [32m7.13254[0m      0.98981      0.91211    0.71593  72.81s
     70       [36m7.04241[0m       7.13448      0.98709      0.93555    0.71015  73.94s
     71       7.06471       [32m7.09309[0m      0.99600      0.89648    0.71073  74.11s
     72       [36m7.00684[0m       7.11823      0.98435      0.86523    0.71097  72.95s
     73       [36m6.97565[0m       [32m7.07906[0m      0.98539      0.89648    0.70858  72.95s
     74       [36m6.97128[0m       [32m7.06978[0m      0.98607      0.90625    0.71578  73.87s
     75       [36m6.93308[0m       [32m6.97973[0m      0.99332      0.90820    0.71727  72.88s
     76       [36m6.91694[0m       7.02270      0.98494      0.89258    0.71915  74.20s
     77       [36m6.88282[0m       7.31866      0.94045      0.69336    0.71661  74.02s
     78       [36m6.87239[0m       7.10323      0.96750      0.66602    0.70849  73.83s
     79       [36m6.85826[0m       [32m6.97168[0m      0.98373      0.88867    0.71067  74.05s
     80       [36m6.83282[0m       [32m6.89853[0m      0.99047      0.92188    0.71532  72.75s
     81       [36m6.80133[0m       6.91945      0.98293      0.91211    0.72201  74.29s
     82       [36m6.77589[0m       6.97836      0.97099      0.85547    0.71189  73.99s
     83       [36m6.75844[0m       [32m6.82982[0m      0.98955      0.90820    0.71589  74.14s
     84       [36m6.73363[0m       7.03119      0.95768      0.66016    0.71663  72.78s
     85       6.73589       6.87942      0.97914      0.92773    0.72353  73.12s
     86       [36m6.69631[0m       6.88715      0.97229      0.90039    0.72202  72.76s
     87       6.69692       [32m6.75446[0m      0.99148      0.91992    0.71709  72.88s
     88       [36m6.64995[0m       6.76303      0.98328      0.91602    0.71846  74.08s
     89       [36m6.63581[0m       7.07551      0.93786      0.64648    0.71743  74.27s
     90       [36m6.60703[0m       6.88995      0.95894      0.66797    0.71758  73.92s
     91       [36m6.58863[0m       6.86691      0.95948      0.66406    0.72419  74.41s
     92       [36m6.57631[0m       6.80324      0.96664      0.67969    0.71548  74.30s
     93       [36m6.53891[0m       6.78089      0.96431      0.88867    0.71876  74.28s
     94       6.55356       [32m6.66398[0m      0.98343      0.92773    0.71902  73.92s
     95       [36m6.52593[0m       6.88721      0.94754      0.68359    0.71734  72.69s
     96       [36m6.50110[0m       6.79911      0.95617      0.67969    0.71641  72.54s
     97       6.51100       6.80208      0.95721      0.67383    0.71997  72.66s
     98       [36m6.47107[0m       [32m6.56102[0m      0.98629      0.92383    0.71851  72.85s
     99       [36m6.45534[0m       6.56244      0.98368      0.92383    0.71997  73.99s
    100       [36m6.41647[0m       6.82429      0.94024      0.66602    0.71686  74.02s
    101       6.41837       6.62548      0.96874      0.91406    0.71777  74.22s
    102       [36m6.37924[0m       [32m6.52826[0m      0.97717      0.90430    0.70917  74.12s
    103       [36m6.35427[0m       [32m6.51139[0m      0.97587      0.91406    0.71745  73.03s
    104       6.37126       [32m6.50777[0m      0.97902      0.90039    0.71440  74.05s
    105       [36m6.33164[0m       [32m6.47117[0m      0.97844      0.89648    0.71504  73.23s
    106       [36m6.31578[0m       [32m6.41697[0m      0.98423      0.91211    0.71769  74.15s
    107       [36m6.29801[0m       6.44004      0.97795      0.92188    0.72208  73.27s
    108       [36m6.29255[0m       [32m6.38847[0m      0.98499      0.92383    0.71998  73.05s
    109       [36m6.26076[0m       [32m6.38009[0m      0.98130      0.90039    0.71588  72.80s
    110       [36m6.23988[0m       6.44681      0.96790      0.89453    0.72331  72.77s
    111       [36m6.21761[0m       6.45519      0.96319      0.67969    0.71595  73.13s
    112       [36m6.19070[0m       [32m6.31543[0m      0.98025      0.93359    0.72347  72.97s
    113       [36m6.16577[0m       [32m6.31214[0m      0.97681      0.91016    0.71621  73.02s
    114       [36m6.15733[0m       [32m6.29728[0m      0.97778      0.91211    0.72012  72.66s
    115       [36m6.13213[0m       6.54319      0.93718      0.69727    0.72929  73.25s
    116       [36m6.10713[0m       [32m6.27281[0m      0.97359      0.92773    0.72119  73.01s
    117       6.12992       6.47658      0.94647      0.66211    0.72527  73.04s
    118       [36m6.09035[0m       [32m6.16710[0m      0.98756      0.92578    0.72295  72.87s
    119       [36m6.07128[0m       6.39431      0.94948      0.66797    0.72267  73.13s
    120       [36m6.05163[0m       6.17951      0.97931      0.91992    0.71827  72.83s
    121       [36m6.01656[0m       6.21918      0.96742      0.93359    0.72284  72.94s
    122       [36m6.00852[0m       [32m6.07258[0m      0.98945      0.93555    0.72635  72.80s
    123       [36m5.99876[0m       6.08925      0.98514      0.90625    0.72515  73.49s
    124       [36m5.96662[0m       6.09846      0.97838      0.91602    0.72435  73.04s
    125       [36m5.95352[0m       6.14818      0.96834      0.93750    0.72234  73.16s
    126       [36m5.94834[0m       6.54011      0.90952      0.66211    0.72247  72.94s
    127       [36m5.93129[0m       [32m5.98939[0m      0.99030      0.94336    0.72865  73.07s
    128       [36m5.91608[0m       6.01138      0.98415      0.93359    0.72643  73.27s
    129       [36m5.88357[0m       6.05670      0.97141      0.93164    0.72430  73.17s
    130       [36m5.86507[0m       [32m5.96139[0m      0.98384      0.93164    0.72258  73.06s
    131       [36m5.84637[0m       5.98230      0.97728      0.92383    0.72382  73.28s
    132       [36m5.83441[0m       6.02822      0.96785      0.94922    0.72679  73.21s
    133       [36m5.81434[0m       5.97347      0.97336      0.93945    0.72625  72.90s
    134       [36m5.79221[0m       [32m5.94840[0m      0.97374      0.92188    0.72469  73.01s
    135       [36m5.77534[0m       [32m5.91769[0m      0.97595      0.92383    0.72095  72.83s
    136       [36m5.75082[0m       5.98132      0.96146      0.91016    0.71639  73.05s
    137       5.76492       6.42317      0.89752      0.68750    0.72285  73.06s
    138       [36m5.74570[0m       [32m5.82245[0m      0.98682      0.94141    0.72671  72.93s
    139       [36m5.71584[0m       [32m5.82213[0m      0.98174      0.94141    0.72538  73.01s
    140       [36m5.70478[0m       5.92557      0.96274      0.93164    0.72516  72.85s
    141       [36m5.68330[0m       5.88250      0.96614      0.93750    0.72338  73.22s
    142       [36m5.65454[0m       5.84233      0.96786      0.92383    0.72092  72.89s
    143       [36m5.63805[0m       [32m5.81522[0m      0.96953      0.91992    0.72095  72.96s
    144       [36m5.63198[0m       5.93025      0.94970      0.92773    0.72116  72.84s
    145       [36m5.61391[0m       [32m5.77177[0m      0.97265      0.92578    0.72077  72.95s
    146       [36m5.59899[0m       [32m5.73440[0m      0.97639      0.94141    0.72496  72.73s
    147       [36m5.57061[0m       [32m5.70683[0m      0.97613      0.91992    0.72264  72.68s
    148       [36m5.56194[0m       5.71179      0.97376      0.94336    0.72585  72.91s
    149       [36m5.54461[0m       5.74474      0.96516      0.91797    0.72108  73.22s
    150       [36m5.54130[0m       [32m5.70587[0m      0.97116      0.93164    0.71953  73.03s
    151       [36m5.52191[0m       5.72234      0.96497      0.91211    0.71682  73.32s
    152       [36m5.50297[0m       [32m5.64169[0m      0.97541      0.93164    0.72430  73.23s
    153       [36m5.49075[0m       [32m5.63967[0m      0.97359      0.92773    0.71671  73.42s
    154       [36m5.46344[0m       [32m5.58549[0m      0.97815      0.92969    0.72801  73.24s
    155       [36m5.45613[0m       5.59675      0.97488      0.92969    0.72035  73.23s
    156       [36m5.44946[0m       5.61100      0.97121      0.92188    0.72218  72.90s
    157       [36m5.41997[0m       [32m5.56539[0m      0.97387      0.92969    0.72144  73.09s
    158       [36m5.39577[0m       [32m5.56488[0m      0.96961      0.93555    0.72323  73.24s
    159       [36m5.37736[0m       [32m5.56284[0m      0.96666      0.93359    0.71976  73.04s
    160       [36m5.36295[0m       [32m5.51748[0m      0.97199      0.93359    0.72379  72.97s
    161       [36m5.34290[0m       5.52467      0.96710      0.93555    0.72349  73.09s
    162       [36m5.32791[0m       [32m5.48815[0m      0.97080      0.93555    0.72566  73.15s
    163       [36m5.31156[0m       [32m5.45950[0m      0.97290      0.94336    0.72927  73.05s
    164       [36m5.30405[0m       5.46989      0.96968      0.93945    0.72650  72.85s
    165       [36m5.29358[0m       [32m5.43430[0m      0.97411      0.92578    0.72847  73.33s
    166       [36m5.28229[0m       5.43950      0.97110      0.93945    0.72437  73.03s
    167       [36m5.25966[0m       5.47652      0.96040      0.92969    0.71776  73.08s
    168       [36m5.24678[0m       5.52735      0.94924      0.91406    0.71626  73.02s
    169       [36m5.21602[0m       5.93793      0.87842      0.68164    0.72170  73.01s
    170       [36m5.21346[0m       [32m5.37370[0m      0.97018      0.93750    0.72415  72.96s
    171       [36m5.19318[0m       [32m5.35934[0m      0.96900      0.93164    0.72606  73.17s
    172       [36m5.18416[0m       5.41928      0.95661      0.92773    0.71955  72.76s
    173       [36m5.17262[0m       [32m5.35857[0m      0.96530      0.93555    0.72046  72.95s
    174       [36m5.15445[0m       5.44609      0.94645      0.91406    0.71908  72.93s
    175       [36m5.13807[0m       [32m5.31891[0m      0.96600      0.94531    0.72141  73.30s
    176       [36m5.12269[0m       5.39084      0.95026      0.93555    0.72507  72.88s
    177       [36m5.09287[0m       [32m5.31492[0m      0.95822      0.92188    0.72325  73.19s
    178       [36m5.09191[0m       [32m5.25457[0m      0.96904      0.93359    0.72545  72.91s
    179       [36m5.07070[0m       5.29444      0.95774      0.92969    0.72523  73.33s
    180       [36m5.06021[0m       5.28434      0.95759      0.92969    0.71952  72.83s
    181       [36m5.03430[0m       [32m5.20634[0m      0.96695      0.93555    0.72383  73.16s
    182       [36m5.02614[0m       [32m5.20309[0m      0.96599      0.92383    0.71834  72.90s
    183       [36m5.01196[0m       [32m5.19585[0m      0.96461      0.94141    0.72443  73.01s
    184       [36m4.99058[0m       5.21534      0.95691      0.93750    0.72293  73.21s
    185       [36m4.97941[0m       5.20010      0.95756      0.93555    0.72070  73.33s
    186       [36m4.96027[0m       5.22508      0.94932      0.92578    0.71321  73.15s
    187       [36m4.94934[0m       [32m5.17341[0m      0.95669      0.92969    0.71999  73.29s
    188       [36m4.93458[0m       [32m5.15685[0m      0.95690      0.93555    0.72590  73.33s
    189       [36m4.92068[0m       [32m5.11859[0m      0.96134      0.92969    0.72560  73.25s
    190       [36m4.90060[0m       5.17641      0.94672      0.92578    0.72396  72.88s
    191       [36m4.89123[0m       [32m5.08832[0m      0.96127      0.93164    0.72527  73.16s
    192       [36m4.88717[0m       [32m5.07738[0m      0.96254      0.93555    0.72198  73.25s
    193       [36m4.85816[0m       [32m5.06223[0m      0.95969      0.92969    0.72385  73.88s
    194       [36m4.85628[0m       [32m5.05293[0m      0.96108      0.93555    0.72418  72.92s
    195       [36m4.84465[0m       5.06229      0.95701      0.92969    0.72097  73.02s
    196       [36m4.82271[0m       5.05965      0.95317      0.92578    0.71957  73.02s
    197       [36m4.80493[0m       [32m5.02269[0m      0.95664      0.93945    0.71858  72.80s
    198       [36m4.80244[0m       [32m5.01172[0m      0.95824      0.94531    0.72178  72.88s
    199       [36m4.78936[0m       [32m4.97080[0m      0.96350      0.93359    0.72262  73.08s
    200       [36m4.77825[0m       4.97375      0.96069      0.92578    0.71656  73.03s
Test:
X_test.shape: (992, 3, 200, 200)
