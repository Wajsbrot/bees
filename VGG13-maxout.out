using CUDNN backend
Train:
X.shape: (3948, 3, 200, 200)
y.shape: (3948,)
y value counts:  [ 823 3125]
pictures size:  1.0
Labels ratio: 3.80
Input arguments: {'load': None, 'scale_delta': 0.1, 'test_file': 'test.npz', 'network': 'VGG13-maxout', 'data_augmentation': 'resampling', 'final_ratio': 1.5, 'activation_function': <function rectify at 0x7f450a310b18>, 'train_file': 'train.npz', 'activation': 'rectify', 'max_trans': 5, 'batch_size': 42, 'dataset_ratio': 3.7970838396111786, 'patience': 10, 'angle_factor': 1.0, 'learning_init': 0.005, 'learning_final': 0.0001, 'max_epochs': 200, 'initial_ratio': None, 'nb_channels': 3, 'lambda2': 0.001, 'crop_size': 200}
Resampling batch iterator parameters: {'count': 0, 'final_ratio': 1.5, 'nb_channels': 3, 'pad_size': 100, 'scale_delta': 0.1, 'output': <open file '<stdout>', mode 'w' at 0x7f4541a51150>, 'dataset_ratio': 3.7970838396111786, 'batch_size': 42, 'angle_factor': 1.0, 'max_epochs': 200, 'max_trans': 5, 'shear': None, 'crop_size': 200}
# Neural Network with 28806722 learnable parameters

## Layer information

name            size           total    cap.Y    cap.X    cov.Y    cov.X    filter Y    filter X    field Y    field X
--------------  -----------  -------  -------  -------  -------  -------  ----------  ----------  ---------  ---------
input0          3x200x200     120000   100.00   100.00   100.00   100.00         200         200        200        200
conv2ddnn1      64x200x200   2560000   100.00   100.00     1.50     1.50           3           3          3          3
conv2ddnn2      64x200x200   2560000    60.00    60.00     2.50     2.50           3           3          5          5
maxpool2ddnn3   64x100x100    640000    60.00    60.00     2.50     2.50           3           3          5          5
conv2ddnn4      128x100x100  1280000    66.67    66.67     4.50     4.50           6           6          9          9
conv2ddnn5      128x100x100  1280000    46.15    46.15     6.50     6.50           6           6         13         13
maxpool2ddnn6   128x50x50     320000    46.15    46.15     6.50     6.50           6           6         13         13
conv2ddnn7      256x50x50     640000    57.14    57.14    10.50    10.50          12          12         21         21
conv2ddnn8      256x50x50     640000    41.38    41.38    14.50    14.50          12          12         29         29
maxpool2ddnn9   256x25x25     160000    41.38    41.38    14.50    14.50          12          12         29         29
conv2ddnn10     512x25x25     320000    53.33    53.33    22.50    22.50          24          24         45         45
conv2ddnn11     512x25x25     320000    39.34    39.34    30.50    30.50          24          24         61         61
maxpool2ddnn12  512x12x12      73728    39.34    39.34    30.50    30.50          24          24         61         61
conv2ddnn13     512x12x12      73728    51.61    51.61    46.50    46.50          48          48         93         93
conv2ddnn14     512x12x12      73728    38.40    38.40    62.50    62.50          48          48        125        125
maxpool2ddnn15  512x6x6        18432    38.40    38.40    62.50    62.50          48          48        125        125
dropout16       512x6x6        18432   100.00   100.00   100.00   100.00         200         200        200        200
dense17         1024            1024   100.00   100.00   100.00   100.00         200         200        200        200
featurepool18   512              512   100.00   100.00   100.00   100.00         200         200        200        200
dropout19       512              512   100.00   100.00   100.00   100.00         200         200        200        200
dense20         1024            1024   100.00   100.00   100.00   100.00         200         200        200        200
featurepool21   512              512   100.00   100.00   100.00   100.00         200         200        200        200
dense22         2                  2   100.00   100.00   100.00   100.00         200         200        200        200

Explanation
    X, Y:    image dimensions
    cap.:    learning capacity
    cov.:    coverage of image
    [35mmagenta[0m: capacity too low (<1/6)
    [36mcyan[0m:    image coverage too high (>100%)
    [31mred[0m:     capacity too low and coverage too high


  epoch    train loss    valid loss    train/val    valid acc    AUC-ROC  dur
-------  ------------  ------------  -----------  -----------  ---------  -------
      1       [36m5.86641[0m       [32m5.84760[0m      1.00322      0.32096    0.62318  409.60s
      2       [36m5.76887[0m       [32m5.80639[0m      0.99354      0.36328    0.62630  409.83s
      3       [36m5.64810[0m       [32m5.57758[0m      1.01264      0.70768    0.82364  409.09s
      4       [36m5.48796[0m       [32m5.35085[0m      1.02562      0.78320    0.84555  410.83s
      5       [36m5.38735[0m       [32m5.29215[0m      1.01799      0.76107    0.86323  409.48s
      6       [36m5.27367[0m       [32m5.28725[0m      0.99743      0.72721    0.86367  410.84s
      7       [36m5.20123[0m       [32m5.16888[0m      1.00626      0.74089    0.86402  410.40s
      8       [36m5.10286[0m       [32m5.09538[0m      1.00147      0.75391    0.89106  409.51s
      9       [36m4.98442[0m       [32m5.05875[0m      0.98531      0.67904    0.88999  409.07s
     10       [36m4.90114[0m       [32m4.90103[0m      1.00002      0.70898    0.88573  409.25s
     11       [36m4.83137[0m       [32m4.76600[0m      1.01372      0.77669    0.91014  409.12s
     12       [36m4.72787[0m       [32m4.66003[0m      1.01456      0.81445    0.88621  409.26s
     13       [36m4.64821[0m       [32m4.52040[0m      1.02827      0.86003    0.92698  409.14s
     14       [36m4.56030[0m       [32m4.46587[0m      1.02115      0.83203    0.90962  409.28s
     15       [36m4.47249[0m       4.53146      0.98699      0.78711    0.93890  409.26s
     16       [36m4.40171[0m       [32m4.30753[0m      1.02186      0.86393    0.93210  409.09s
     17       [36m4.31489[0m       [32m4.30056[0m      1.00333      0.79167    0.89889  408.85s
     18       [36m4.25196[0m       [32m4.17093[0m      1.01943      0.86979    0.94060  409.49s
     19       [36m4.16361[0m       [32m4.12751[0m      1.00875      0.81641    0.92243  409.35s
     20       [36m4.10623[0m       [32m4.07452[0m      1.00778      0.83464    0.95677  409.17s
     21       [36m4.04244[0m       [32m3.97970[0m      1.01576      0.89844    0.93972  409.24s
     22       [36m3.98487[0m       3.98037      1.00113      0.81706    0.95267  408.96s
     23       [36m3.91888[0m       4.00836      0.97768      0.77083    0.91359  408.93s
     24       [36m3.85312[0m       [32m3.84285[0m      1.00267      0.82943    0.94449  408.86s
     25       [36m3.76172[0m       3.86428      0.97346      0.81315    0.93563  409.07s
     26       [36m3.69809[0m       [32m3.71185[0m      0.99629      0.86198    0.95139  409.15s
     27       [36m3.64174[0m       3.83503      0.94960      0.78385    0.94162  409.10s
     28       [36m3.59353[0m       [32m3.64794[0m      0.98508      0.83854    0.93308  409.02s
     29       [36m3.54802[0m       [32m3.54080[0m      1.00204      0.86003    0.95622  409.27s
     30       [36m3.48741[0m       [32m3.47964[0m      1.00224      0.85091    0.94305  409.24s
     31       [36m3.42771[0m       [32m3.40688[0m      1.00611      0.86068    0.94624  409.08s
     32       [36m3.37173[0m       [32m3.35620[0m      1.00463      0.88086    0.95306  408.86s
     33       [36m3.31712[0m       [32m3.31999[0m      0.99913      0.86784    0.96091  408.94s
     34       [36m3.27248[0m       [32m3.23282[0m      1.01227      0.86263    0.95640  409.06s
     35       [36m3.20621[0m       [32m3.21121[0m      0.99844      0.86068    0.94850  409.33s
     36       [36m3.14678[0m       3.26147      0.96483      0.83138    0.96036  409.12s
     37       [36m3.10193[0m       [32m3.11622[0m      0.99541      0.87500    0.95655  409.12s
     38       [36m3.05601[0m       3.32958      0.91784      0.79753    0.92851  409.02s
     39       [36m2.98892[0m       [32m3.05171[0m      0.97943      0.87370    0.95568  409.32s
     40       [36m2.95616[0m       [32m2.91718[0m      1.01336      0.91406    0.95592  409.37s
     41       [36m2.89686[0m       [32m2.90203[0m      0.99822      0.90234    0.95729  409.52s
     42       [36m2.85938[0m       3.01957      0.94695      0.83008    0.95970  409.31s
     43       [36m2.81183[0m       [32m2.85177[0m      0.98600      0.87435    0.96381  409.35s
     44       [36m2.77967[0m       2.90771      0.95597      0.85417    0.94284  409.04s
     45       [36m2.72593[0m       [32m2.74263[0m      0.99391      0.90039    0.95827  409.16s
     46       [36m2.69425[0m       [32m2.72418[0m      0.98901      0.86589    0.96423  409.08s
     47       [36m2.62257[0m       [32m2.60644[0m      1.00619      0.89518    0.97353  409.16s
     48       [36m2.59827[0m       [32m2.60222[0m      0.99848      0.91602    0.96600  409.26s
     49       [36m2.55959[0m       [32m2.60072[0m      0.98419      0.89193    0.95980  409.18s
     50       [36m2.53215[0m       2.62467      0.96475      0.83464    0.95995  409.24s
     51       [36m2.47976[0m       [32m2.56959[0m      0.96504      0.88672    0.95284  409.39s
     52       [36m2.43994[0m       [32m2.48568[0m      0.98160      0.88932    0.95387  409.01s
     53       [36m2.40932[0m       [32m2.46045[0m      0.97922      0.87760    0.95221  409.28s
     54       [36m2.37054[0m       [32m2.38321[0m      0.99468      0.91211    0.96027  409.20s
     55       [36m2.34167[0m       [32m2.32564[0m      1.00689      0.91016    0.96783  409.30s
     56       [36m2.29074[0m       2.34914      0.97514      0.88216    0.95523  408.98s
     57       [36m2.26486[0m       [32m2.29226[0m      0.98805      0.88737    0.95338  409.14s
     58       [36m2.23397[0m       2.34219      0.95379      0.87500    0.96128  409.01s
     59       [36m2.19379[0m       2.43449      0.90113      0.81901    0.94639  409.23s
     60       [36m2.17666[0m       [32m2.22251[0m      0.97937      0.88346    0.95721  409.21s
     61       [36m2.11538[0m       [32m2.16001[0m      0.97934      0.91081    0.96414  409.08s
     62       [36m2.09471[0m       2.16578      0.96719      0.89844    0.95803  409.05s
     63       [36m2.04684[0m       2.18920      0.93497      0.87695    0.96540  408.99s
     64       [36m2.01890[0m       [32m2.09922[0m      0.96174      0.88932    0.96011  409.27s
     65       [36m1.97849[0m       2.14773      0.92120      0.87174    0.96804  409.19s
     66       [36m1.97038[0m       [32m2.00929[0m      0.98064      0.88737    0.97080  409.11s
     67       [36m1.93669[0m       2.01947      0.95901      0.89844    0.96863  409.26s
     68       [36m1.91822[0m       [32m1.92654[0m      0.99568      0.90299    0.95978  409.09s
     69       [36m1.87982[0m       2.03448      0.92398      0.85612    0.96808  409.15s
     70       [36m1.86242[0m       1.94388      0.95809      0.88542    0.95637  409.34s
     71       [36m1.82883[0m       [32m1.84146[0m      0.99314      0.90690    0.97205  409.35s
     72       [36m1.78879[0m       1.86561      0.95882      0.89844    0.97050  409.47s
     73       [36m1.76912[0m       [32m1.79584[0m      0.98512      0.91602    0.97218  409.48s
     74       [36m1.75170[0m       1.85238      0.94565      0.88477    0.96942  409.33s
     75       [36m1.70651[0m       1.81958      0.93786      0.86393    0.96995  409.32s
     76       [36m1.68830[0m       [32m1.75017[0m      0.96465      0.89714    0.96723  409.19s
     77       [36m1.66236[0m       1.78353      0.93206      0.86003    0.97222  409.05s
     78       [36m1.63416[0m       1.78651      0.91472      0.86979    0.95736  409.16s
     79       [36m1.62737[0m       [32m1.68893[0m      0.96356      0.88542    0.96961  409.14s
     80       [36m1.58977[0m       1.74530      0.91089      0.87565    0.96331  409.24s
     81       [36m1.55970[0m       1.71017      0.91201      0.87565    0.96121  409.27s
     82       [36m1.53749[0m       [32m1.67602[0m      0.91735      0.88086    0.96355  409.21s
     83       [36m1.52598[0m       [32m1.64341[0m      0.92855      0.85612    0.96383  409.21s
     84       [36m1.49567[0m       [32m1.58323[0m      0.94470      0.88346    0.96427  409.09s
     85       [36m1.47392[0m       [32m1.55992[0m      0.94487      0.88216    0.97106  409.09s
     86       [36m1.45254[0m       [32m1.50829[0m      0.96304      0.91276    0.96854  409.12s
     87       [36m1.44148[0m       [32m1.47804[0m      0.97526      0.91211    0.97048  409.15s
     88       [36m1.42424[0m       1.51427      0.94054      0.89714    0.95417  409.11s
     89       [36m1.39373[0m       1.51687      0.91882      0.91276    0.95430  409.21s
     90       [36m1.35843[0m       1.50317      0.90371      0.91276    0.96383  410.01s
     91       1.38007       [32m1.43270[0m      0.96326      0.89128    0.96096  409.43s
     92       [36m1.35458[0m       [32m1.41642[0m      0.95634      0.89323    0.97530  410.00s
     93       [36m1.31355[0m       1.43563      0.91497      0.86328    0.96701  409.29s
     94       [36m1.28675[0m       1.43870      0.89439      0.90885    0.96306  410.28s
     95       [36m1.27968[0m       [32m1.35999[0m      0.94095      0.87565    0.96559  410.04s
     96       [36m1.26109[0m       1.39775      0.90223      0.89323    0.96727  409.75s
     97       [36m1.24451[0m       1.50974      0.82432      0.86589    0.95835  409.54s
     98       [36m1.21590[0m       [32m1.34621[0m      0.90320      0.90690    0.96203  409.61s
     99       [36m1.20606[0m       [32m1.25387[0m      0.96186      0.91471    0.97614  409.23s
    100       [36m1.18666[0m       1.25651      0.94441      0.89193    0.97686  409.72s
    101       [36m1.18452[0m       1.27057      0.93227      0.89518    0.97239  409.75s
    102       [36m1.14338[0m       [32m1.24745[0m      0.91657      0.89714    0.96542  409.24s
    103       [36m1.13210[0m       [32m1.24662[0m      0.90814      0.90299    0.96301  409.13s
    104       1.13361       [32m1.23007[0m      0.92159      0.88346    0.96546  409.35s
    105       [36m1.10718[0m       [32m1.22186[0m      0.90614      0.91276    0.96991  408.97s
    106       [36m1.09716[0m       [32m1.16736[0m      0.93987      0.89128    0.96976  409.19s
    107       1.10272       1.22665      0.89897      0.87760    0.95973  408.98s
    108       [36m1.06013[0m       [32m1.11401[0m      0.95163      0.89323    0.97383  409.06s
    109       [36m1.02859[0m       1.16416      0.88354      0.88737    0.97490  409.13s
    110       [36m1.02039[0m       1.19414      0.85449      0.88737    0.95921  409.10s
    111       [36m1.00659[0m       1.18250      0.85124      0.90104    0.97504  409.44s
    112       [36m1.00622[0m       1.15212      0.87337      0.89128    0.95463  409.21s
    113       [36m0.99296[0m       1.16078      0.85542      0.90690    0.95974  409.33s
    114       [36m0.98329[0m       1.24349      0.79075      0.86393    0.95990  408.82s
    115       [36m0.97096[0m       [32m1.09922[0m      0.88332      0.89714    0.96487  409.04s
    116       [36m0.94808[0m       1.17470      0.80708      0.88802    0.95983  409.03s
    117       [36m0.94400[0m       [32m1.05722[0m      0.89291      0.89323    0.97631  408.94s
    118       [36m0.92492[0m       1.09769      0.84261      0.89974    0.96491  409.20s
    119       0.94982       [32m0.95725[0m      0.99225      0.91276    0.97375  409.29s
    120       [36m0.91035[0m       1.04427      0.87176      0.88281    0.97317  409.07s
    121       [36m0.88558[0m       1.02840      0.86113      0.89323    0.97387  409.18s
    122       [36m0.88331[0m       0.99343      0.88916      0.90690    0.97604  408.94s
    123       [36m0.87053[0m       1.02232      0.85152      0.88151    0.96464  409.07s
    124       0.87250       1.08572      0.80362      0.87891    0.96990  409.11s
    125       [36m0.82887[0m       1.05056      0.78898      0.91081    0.96997  409.17s
    126       0.83233       0.95892      0.86799      0.90690    0.96620  408.99s
    127       0.83480       0.97342      0.85759      0.90495    0.96167  408.94s
    128       [36m0.81356[0m       1.06094      0.76683      0.86979    0.95775  409.13s
    129       [36m0.79025[0m       [32m0.91397[0m      0.86464      0.90690    0.97265  409.12s
    130       [36m0.78015[0m       0.99063      0.78753      0.89518    0.97025  409.18s
    131       [36m0.77688[0m       [32m0.86910[0m      0.89389      0.91211    0.96823  409.23s
    132       [36m0.77352[0m       0.93942      0.82340      0.89714    0.95843  409.00s
    133       [36m0.74007[0m       0.88524      0.83601      0.91797    0.97284  409.37s
    134       0.75465       0.89607      0.84218      0.91276    0.96125  409.15s
    135       [36m0.73156[0m       [32m0.84476[0m      0.86600      0.89909    0.97490  409.26s
    136       0.73629       0.93986      0.78341      0.89909    0.96718  409.16s
    137       [36m0.71696[0m       0.95944      0.74727      0.88932    0.95710  409.25s
    138       [36m0.70439[0m       0.94578      0.74477      0.92057    0.95792  409.22s
    139       0.71059       0.90392      0.78612      0.88411    0.96464  409.26s
    140       [36m0.70112[0m       0.86789      0.80784      0.90495    0.97296  409.20s
    141       [36m0.68819[0m       0.85219      0.80756      0.88932    0.96453  409.27s
    142       [36m0.67328[0m       [32m0.82740[0m      0.81373      0.90104    0.95959  409.26s
    143       [36m0.66759[0m       0.88119      0.75760      0.89193    0.95367  409.02s
    144       [36m0.65973[0m       0.86259      0.76483      0.90104    0.95543  409.06s
    145       0.66024       [32m0.76953[0m      0.85798      0.91276    0.96673  408.91s
    146       [36m0.64785[0m       0.78308      0.82731      0.91276    0.96080  409.15s
    147       [36m0.64059[0m       0.81832      0.78281      0.89128    0.96361  409.21s
    148       [36m0.63488[0m       0.80600      0.78769      0.89518    0.96871  409.00s
    149       0.64838       [32m0.74667[0m      0.86836      0.89128    0.97226  409.17s
    150       [36m0.63467[0m       0.75545      0.84011      0.91276    0.96907  409.23s
    151       [36m0.60859[0m       0.77538      0.78490      0.91081    0.97554  409.07s
    152       [36m0.59460[0m       [32m0.72746[0m      0.81736      0.91276    0.97118  409.04s
    153       [36m0.58753[0m       0.80235      0.73226      0.90299    0.94879  409.25s
    154       0.60347       0.77640      0.77727      0.88542    0.96751  409.18s
    155       0.59522       [32m0.68158[0m      0.87330      0.91471    0.97763  409.21s
    156       [36m0.57807[0m       0.76306      0.75757      0.92448    0.96800  409.20s
    157       [36m0.57358[0m       [32m0.63994[0m      0.89631      0.93750    0.97287  409.11s
    158       [36m0.55346[0m       0.77270      0.71627      0.91081    0.97216  409.12s
    159       [36m0.53895[0m       0.68776      0.78363      0.91081    0.96895  409.10s
    160       0.55245       0.68572      0.80564      0.90495    0.97876  409.16s
    161       0.54372       0.64763      0.83955      0.91667    0.97623  409.21s
    162       [36m0.53694[0m       0.72695      0.73862      0.89779    0.97405  409.16s
    163       [36m0.52947[0m       0.65768      0.80506      0.92253    0.97100  409.40s
    164       0.53643       0.66800      0.80304      0.90169    0.97356  409.05s
    165       [36m0.52231[0m       0.83637      0.62450      0.88932    0.94629  409.17s
    166       [36m0.51996[0m       0.66815      0.77820      0.91081    0.96107  409.36s
    167       [36m0.50471[0m       0.75231      0.67089      0.88672    0.97082  409.14s
    168       0.51587       [32m0.60158[0m      0.85752      0.90495    0.97550  409.25s
    169       0.51525       0.64636      0.79715      0.92578    0.97444  409.16s
    170       [36m0.49847[0m       0.64281      0.77545      0.92643    0.96848  409.10s
    171       [36m0.47852[0m       0.62369      0.76724      0.91276    0.97166  409.16s
    172       0.48115       0.69831      0.68902      0.89909    0.95036  409.12s
    173       0.49055       0.70258      0.69821      0.91471    0.95846  409.15s
    174       0.48332       0.70685      0.68377      0.91081    0.96384  409.12s
    175       [36m0.47386[0m       [32m0.59873[0m      0.79145      0.89518    0.96683  409.05s
    176       0.48033       [32m0.59517[0m      0.80705      0.92057    0.97023  409.31s
    177       [36m0.46288[0m       0.62470      0.74096      0.90885    0.97728  409.08s
    178       [36m0.44809[0m       0.63346      0.70737      0.89323    0.96750  409.10s
    179       [36m0.44735[0m       0.67357      0.66415      0.90299    0.95779  408.97s
    180       [36m0.44042[0m       0.63484      0.69376      0.89323    0.96957  409.18s
    181       0.45142       0.60221      0.74960      0.90495    0.96960  409.21s
    182       0.44567       [32m0.58749[0m      0.75860      0.91276    0.97431  409.05s
    183       [36m0.42850[0m       [32m0.56779[0m      0.75468      0.91862    0.97286  408.99s
    184       0.43576       [32m0.55945[0m      0.77892      0.90495    0.96523  409.14s
    185       [36m0.42022[0m       [32m0.54523[0m      0.77072      0.91471    0.97071  409.14s
    186       [36m0.41275[0m       0.56910      0.72527      0.90885    0.97163  409.15s
    187       [36m0.40068[0m       0.69263      0.57848      0.90299    0.96211  409.16s
    188       0.43365       0.55366      0.78324      0.88802    0.96471  409.10s
    189       0.43178       0.55952      0.77169      0.89779    0.96979  409.01s
    190       0.42112       0.56566      0.74446      0.92839    0.97746  408.97s
    191       0.40271       [32m0.50453[0m      0.79819      0.92448    0.97143  408.89s
    192       [36m0.39140[0m       0.64528      0.60655      0.91081    0.97128  409.04s
    193       0.40508       0.57009      0.71056      0.91471    0.96168  408.92s
    194       0.39981       0.51719      0.77304      0.90885    0.97349  409.02s
    195       [36m0.39036[0m       [32m0.47669[0m      0.81890      0.94531    0.97217  408.99s
    196       0.40020       0.59954      0.66751      0.88151    0.97371  409.06s
    197       0.39662       0.54162      0.73228      0.90820    0.96484  409.14s
    198       0.40709       0.50093      0.81268      0.92578    0.96201  408.86s
    199       0.41176       0.50651      0.81293      0.88997    0.96899  408.86s
    200       0.41237       0.48165      0.85615      0.92578    0.97145  409.05s
Test:
X_test.shape: (992, 3, 200, 200)
