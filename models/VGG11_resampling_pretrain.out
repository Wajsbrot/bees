Training parameters:  {'load': None, 'test_file': 'test_unbalanced.npz', 'network': 'VGG11', 'final_ratio': 1.5, 'train_file': 'train_unbalanced.npz', 'activation': 'rectify', 'batch_size': 48, 'channels': 3, 'data_aug': 'resampling', 'max_epochs': 50, 'learning_rate': 0.005, 'lambda2': 0.0005, 'crop_size': 200}
Train:
X.shape: (3936, 3, 200, 200)
y.shape: (3936,)
y value counts:  [ 822 3114]
Labels ratio: 3.79
{'verbose': 3, 'y_tensor_type': TensorType(int32, vector), 'update_learning_rate': <CudaNdarrayType(float32, scalar)>, 'batch_iterator_test': <nolearn.lasagne.base.BatchIterator object at 0x7f51101ed3d0>, 'update_momentum': <CudaNdarrayType(float32, scalar)>, 'objective_lambda2': 0.0005, 'max_epochs': 50, 'regression': False, 'layers': [(<class 'lasagne.layers.input.InputLayer'>, {'shape': (None, 3, 200, 200)}), (<class 'lasagne.layers.conv.Conv2DLayer'>, {'filter_size': (3, 3), 'pad': 1, 'nonlinearity': <function rectify at 0x7f511b251758>, 'num_filters': 64}), (<class 'lasagne.layers.pool.MaxPool2DLayer'>, {'pool_size': (2, 2)}), (<class 'lasagne.layers.conv.Conv2DLayer'>, {'filter_size': (3, 3), 'pad': 1, 'nonlinearity': <function rectify at 0x7f511b251758>, 'num_filters': 128}), (<class 'lasagne.layers.pool.MaxPool2DLayer'>, {'pool_size': (2, 2)}), (<class 'lasagne.layers.conv.Conv2DLayer'>, {'filter_size': (3, 3), 'pad': 1, 'nonlinearity': <function rectify at 0x7f511b251758>, 'num_filters': 256}), (<class 'lasagne.layers.conv.Conv2DLayer'>, {'filter_size': (3, 3), 'pad': 1, 'nonlinearity': <function rectify at 0x7f511b251758>, 'num_filters': 256}), (<class 'lasagne.layers.pool.MaxPool2DLayer'>, {'pool_size': (2, 2)}), (<class 'lasagne.layers.conv.Conv2DLayer'>, {'filter_size': (3, 3), 'pad': 1, 'nonlinearity': <function rectify at 0x7f511b251758>, 'num_filters': 512}), (<class 'lasagne.layers.conv.Conv2DLayer'>, {'filter_size': (3, 3), 'pad': 1, 'nonlinearity': <function rectify at 0x7f511b251758>, 'num_filters': 512}), (<class 'lasagne.layers.pool.MaxPool2DLayer'>, {'pool_size': (2, 2)}), (<class 'lasagne.layers.conv.Conv2DLayer'>, {'filter_size': (3, 3), 'pad': 1, 'nonlinearity': <function rectify at 0x7f511b251758>, 'num_filters': 512}), (<class 'lasagne.layers.conv.Conv2DLayer'>, {'filter_size': (3, 3), 'pad': 1, 'nonlinearity': <function rectify at 0x7f511b251758>, 'num_filters': 512}), (<class 'lasagne.layers.pool.MaxPool2DLayer'>, {'pool_size': (2, 2)}), (<class 'lasagne.layers.dense.DenseLayer'>, {'num_units': 4096, 'nonlinearity': <function rectify at 0x7f511b251758>}), (<class 'lasagne.layers.noise.DropoutLayer'>, {}), (<class 'lasagne.layers.dense.DenseLayer'>, {'num_units': 4096, 'nonlinearity': <function rectify at 0x7f511b251758>}), (<class 'lasagne.layers.noise.DropoutLayer'>, {}), (<class 'lasagne.layers.dense.DenseLayer'>, {'num_units': 2, 'nonlinearity': <function softmax at 0x7f511b251668>})], 'batch_iterator_train': <data_augmentation.ResamplingBatchIterator object at 0x7f510d4a8a10>, '_kwarg_keys': ['update_momentum', 'objective_lambda2', 'update_learning_rate'], 'on_epoch_finished': [<adaptative_learning.AdjustVariable object at 0x7f510cfeba50>, <adaptative_learning.AdjustVariable object at 0x7f510d00b310>, <adaptative_learning.EarlyStopping object at 0x7f510d00b350>, <nolearn.lasagne.handlers.PrintLog instance at 0x7f510d0041b8>], 'objective': <function regularization_objective at 0x7f510d483cf8>, 'use_label_encoder': False, 'objective_loss_function': <function categorical_crossentropy at 0x7f511a06fed8>, 'update': <function nesterov_momentum at 0x7f511a073668>, 'custom_score': ('AUC-ROC', <function auc_roc at 0x7f510cfe4b90>), 'on_batch_finished': [], 'on_training_started': [<nolearn.lasagne.handlers.PrintLayerInfo instance at 0x7f510d004200>], 'more_params': {}, 'on_training_finished': [], 'train_history_': [], 'train_split': <nolearn.lasagne.base.TrainSplit object at 0x7f510d00b390>}
# Neural Network with 101511554 learnable parameters

## Layer information

name         size           total    cap.Y    cap.X    cov.Y    cov.X    filter Y    filter X    field Y    field X
-----------  -----------  -------  -------  -------  -------  -------  ----------  ----------  ---------  ---------
input0       3x200x200     120000   100.00   100.00   100.00   100.00         200         200        200        200
conv2d1      64x200x200   2560000   100.00   100.00     1.50     1.50           3           3          3          3
maxpool2d2   64x100x100    640000   100.00   100.00     1.50     1.50           3           3          3          3
conv2d3      128x100x100  1280000    85.71    85.71     3.50     3.50           6           6          7          7
maxpool2d4   128x50x50     320000    85.71    85.71     3.50     3.50           6           6          7          7
conv2d5      256x50x50     640000    80.00    80.00     7.50     7.50          12          12         15         15
conv2d6      256x50x50     640000    52.17    52.17    11.50    11.50          12          12         23         23
maxpool2d7   256x25x25     160000    52.17    52.17    11.50    11.50          12          12         23         23
conv2d8      512x25x25     320000    61.54    61.54    19.50    19.50          24          24         39         39
conv2d9      512x25x25     320000    43.64    43.64    27.50    27.50          24          24         55         55
maxpool2d10  512x12x12      73728    43.64    43.64    27.50    27.50          24          24         55         55
conv2d11     512x12x12      73728    55.17    55.17    43.50    43.50          48          48         87         87
conv2d12     512x12x12      73728    40.34    40.34    59.50    59.50          48          48        119        119
maxpool2d13  512x6x6        18432    40.34    40.34    59.50    59.50          48          48        119        119
dense14      4096            4096   100.00   100.00   100.00   100.00         200         200        200        200
dropout15    4096            4096   100.00   100.00   100.00   100.00         200         200        200        200
dense16      4096            4096   100.00   100.00   100.00   100.00         200         200        200        200
dropout17    4096            4096   100.00   100.00   100.00   100.00         200         200        200        200
dense18      2                  2   100.00   100.00   100.00   100.00         200         200        200        200

Explanation
    X, Y:    image dimensions
    cap.:    learning capacity
    cov.:    coverage of image
    [35mmagenta[0m: capacity too low (<1/6)
    [36mcyan[0m:    image coverage too high (>100%)
    [31mred[0m:     capacity too low and coverage too high


  epoch    train loss    valid loss    train/val    valid acc    AUC-ROC  dur
-------  ------------  ------------  -----------  -----------  ---------  -------
      1       [36m7.26316[0m       [32m7.21570[0m      1.00658      0.59215    0.71774  284.58s
      2       [36m7.15430[0m       [32m7.06618[0m      1.01247      0.73846    0.78612  284.36s
      3       [36m7.05090[0m       [32m6.95139[0m      1.01432      0.74503    0.80080  284.08s
      4       [36m6.97845[0m       [32m6.87240[0m      1.01543      0.79510    0.85323  284.38s
      5       [36m6.89476[0m       [32m6.84812[0m      1.00681      0.77823    0.86416  284.27s
      6       [36m6.80973[0m       [32m6.81375[0m      0.99941      0.79705    0.88995  284.85s
      7       [36m6.78199[0m       [32m6.77340[0m      1.00127      0.76261    0.89483  284.75s
      8       [36m6.67959[0m       [32m6.67696[0m      1.00039      0.74893    0.89437  284.96s
      9       [36m6.61345[0m       6.77736      0.97582      0.69620    0.88723  284.96s
     10       [36m6.59231[0m       [32m6.53928[0m      1.00811      0.83416    0.87425  284.55s
     11       [36m6.51267[0m       [32m6.45690[0m      1.00864      0.86080    0.90117  284.69s
     12       [36m6.46316[0m       [32m6.44563[0m      1.00272      0.78018    0.91681  284.46s
     13       [36m6.39038[0m       [32m6.35882[0m      1.00496      0.85565    0.90820  284.53s
     14       [36m6.34128[0m       [32m6.31933[0m      1.00347      0.85565    0.90375  284.50s
     15       [36m6.28744[0m       [32m6.28405[0m      1.00054      0.77042    0.92953  284.63s
     16       [36m6.23971[0m       [32m6.23887[0m      1.00014      0.80558    0.92352  284.48s
     17       [36m6.15997[0m       6.25152      0.98536      0.77237    0.90530  284.47s
     18       [36m6.13476[0m       [32m6.09057[0m      1.00725      0.87376    0.95461  284.66s
     19       [36m6.08142[0m       [32m6.08106[0m      1.00006      0.84641    0.94604  284.62s
     20       [36m6.01700[0m       [32m6.00554[0m      1.00191      0.86665    0.93592  284.64s
     21       [36m5.98102[0m       [32m6.00232[0m      0.99645      0.82564    0.93656  284.45s
     22       [36m5.92832[0m       [32m5.91354[0m      1.00250      0.88938    0.94664  284.62s
     23       [36m5.88677[0m       [32m5.89221[0m      0.99908      0.85103    0.93900  284.42s
     24       [36m5.84009[0m       [32m5.78979[0m      1.00869      0.88352    0.97210  284.65s
     25       [36m5.77450[0m       [32m5.73224[0m      1.00737      0.87837    0.95893  284.59s
     26       [36m5.74635[0m       [32m5.68353[0m      1.01105      0.90110    0.95243  284.66s
     27       [36m5.69982[0m       [32m5.63168[0m      1.01210      0.89719    0.96532  284.51s
     28       [36m5.65543[0m       5.72212      0.98835      0.88033    0.93858  284.52s
     29       [36m5.60768[0m       5.63491      0.99517      0.88619    0.93866  284.43s
     30       [36m5.55520[0m       [32m5.54906[0m      1.00111      0.86665    0.94978  284.56s
     31       [36m5.51189[0m       [32m5.51652[0m      0.99916      0.88423    0.95657  284.40s
     32       [36m5.49210[0m       [32m5.43283[0m      1.01091      0.91477    0.97425  284.48s
     33       [36m5.43290[0m       [32m5.41319[0m      1.00364      0.89329    0.97160  284.43s
     34       [36m5.37677[0m       5.42073      0.99189      0.91868    0.94811  284.45s
     35       [36m5.35082[0m       [32m5.35825[0m      0.99861      0.91673    0.94775  284.56s
     36       [36m5.29292[0m       [32m5.28385[0m      1.00172      0.91282    0.97148  284.63s
     37       [36m5.25998[0m       [32m5.25244[0m      1.00144      0.91477    0.97344  284.67s
     38       [36m5.23628[0m       [32m5.20710[0m      1.00560      0.89595    0.96932  284.58s
     39       [36m5.19021[0m       [32m5.18239[0m      1.00151      0.88814    0.96941  284.38s
     40       [36m5.14629[0m       [32m5.17489[0m      0.99447      0.92259    0.96828  284.41s
     41       [36m5.09052[0m       [32m5.05870[0m      1.00629      0.93945    0.97843  284.45s
     42       [36m5.03811[0m       5.07524      0.99268      0.89205    0.97608  284.67s
     43       [36m5.02744[0m       5.17616      0.97127      0.89790    0.94224  284.86s
     44       [36m4.99972[0m       [32m4.96269[0m      1.00746      0.91087    0.97365  284.81s
     45       [36m4.95860[0m       [32m4.94082[0m      1.00360      0.91477    0.97216  284.78s
     46       [36m4.92954[0m       [32m4.90925[0m      1.00413      0.89595    0.96645  284.47s
     47       [36m4.87435[0m       [32m4.84583[0m      1.00588      0.92063    0.97653  284.44s
     48       [36m4.83750[0m       4.87764      0.99177      0.92063    0.95818  284.51s
     49       [36m4.79828[0m       [32m4.77524[0m      1.00482      0.90891    0.97877  284.42s
     50       [36m4.76066[0m       4.77994      0.99597      0.90501    0.96906  284.56s
Test:
X_test.shape: (992, 3, 200, 200)
